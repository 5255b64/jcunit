<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>JCUnit by dakusui</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/dakusui/jcunit">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/dakusui/jcunit/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/dakusui/jcunit/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>JCUnit</h1>
          <p>A combinatorial testing framework on top of JUnit + Model-based testing. It makes your testing life a lot easier.</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/dakusui">dakusui</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a id="jcunit" class="anchor" href="#jcunit" aria-hidden="true"><span class="octicon octicon-link"></span></a>JCUnit</h1>

<p>JCUnit is a framework to perform combinatorial tests using 'pairwise'(or more generally 't-wise') 
technique.
About what combinatorial testings are, articles below are useful as a starting point.</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/All-pairs_testing">All-pairs testing</a></li>
<li><a href="http://mse.isri.cmu.edu/software-engineering/documents/faculty-publications/miranda/kuhnintroductioncombinatorialtesting.pdf">Introduction to Combinatorial Testing</a></li>
</ul>

<p>Very roughly to say, it's a technique to generate test cases with good 'coverage' 
without making the number of test cases explode.</p>

<h1>
<a id="first-test-with-jcunit" class="anchor" href="#first-test-with-jcunit" aria-hidden="true"><span class="octicon octicon-link"></span></a>First test with JCUnit</h1>

<p>Below is JCUnit's most basic example 'QuadraticEquationSolver.java'.
Just by running QuadraticEquationSolverTest.java as a usual JUnit test, JCUnit will 
automatically generate test cases based on '@FactorField' annotations.</p>

<h2>
<a id="quadraticequationsolver-program-example" class="anchor" href="#quadraticequationsolver-program-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>QuadraticEquationSolver program example</h2>

<p>To understand JCUnit's functions, let's test 'QuadraticEquationSolver.java' program, which solves 'quadratic equations' using a formula.
The program contains some intentional bugs and unclear specifications (or behaviors).
The formula it uses is,</p>

<div class="highlight highlight-source-java"><pre>
    {x1, x2} <span class="pl-k">=</span> { (<span class="pl-k">-</span>b <span class="pl-k">+</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>sqrt(b<span class="pl-k">*</span>b <span class="pl-k">-</span> <span class="pl-c1">4</span><span class="pl-k">*</span>c<span class="pl-k">*</span>a)) <span class="pl-k">/</span> <span class="pl-c1">2</span><span class="pl-k">*</span>a, (<span class="pl-k">-</span>b <span class="pl-k">-</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>sqrt(b<span class="pl-k">*</span>b <span class="pl-k">-</span> <span class="pl-c1">4</span><span class="pl-k">*</span>c<span class="pl-k">*</span>a)) <span class="pl-k">/</span> <span class="pl-c1">2</span><span class="pl-k">*</span>a }
</pre></div>

<p>where {x1, x2} are the solutions of an equation, </p>

<div class="highlight highlight-source-java"><pre>
    a <span class="pl-k">*</span> x<span class="pl-k">^</span><span class="pl-c1">2</span> <span class="pl-k">+</span> b <span class="pl-k">*</span> x <span class="pl-k">+</span> c <span class="pl-k">=</span> <span class="pl-c1">0</span>
</pre></div>

<h3>
<a id="maven-coordinate" class="anchor" href="#maven-coordinate" aria-hidden="true"><span class="octicon octicon-link"></span></a>Maven coordinate</h3>

<p>First of all, you will need to link JCUnit to your project.
Below is a pom.xml fragment to describe jcunit's dependency.
Please add it to your project's pom.xml </p>

<div class="highlight highlight-text-xml"><pre>
    &lt;<span class="pl-ent">dependency</span>&gt;
      &lt;<span class="pl-ent">groupId</span>&gt;com.github.dakusui&lt;/<span class="pl-ent">groupId</span>&gt;
      &lt;<span class="pl-ent">artifactId</span>&gt;jcunit&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;<span class="pl-ent">version</span>&gt;0.5.5&lt;/<span class="pl-ent">version</span>&gt;
    &lt;/<span class="pl-ent">dependency</span>&gt;
</pre></div>

<h3>
<a id="quadraticequationsolverjava-main-class-sut" class="anchor" href="#quadraticequationsolverjava-main-class-sut" aria-hidden="true"><span class="octicon octicon-link"></span></a>QuadraticEquationSolver.java (Main class, SUT)</h3>

<p>'QuadraticEquationSolver' is the SUT (Software under test) in this example.
The class provides a function to solve a quadratic equation using a quadratic formula and returns the solutions.</p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-c">//QuadraticEquationSolver.java</span>
    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">QuadraticEquationSolver</span> {
      <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">double</span> a;
      <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">double</span> b;
      <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">double</span> c;

      <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">Solutions</span> {
        <span class="pl-k">public</span> <span class="pl-k">final</span> <span class="pl-k">double</span> x1;
        <span class="pl-k">public</span> <span class="pl-k">final</span> <span class="pl-k">double</span> x2;

        <span class="pl-k">public</span> <span class="pl-en">Solutions</span>(<span class="pl-k">double</span> <span class="pl-v">x1</span>, <span class="pl-k">double</span> <span class="pl-v">x2</span>) {
          <span class="pl-v">this</span><span class="pl-k">.</span>x1 <span class="pl-k">=</span> x1;
          <span class="pl-v">this</span><span class="pl-k">.</span>x2 <span class="pl-k">=</span> x2;
        }

        <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">toString</span>() {
          <span class="pl-k">return</span> <span class="pl-smi">String</span><span class="pl-k">.</span>format(<span class="pl-s"><span class="pl-pds">"</span>(%f,%f)<span class="pl-pds">"</span></span>, x1, x2);
        }
      }

      <span class="pl-k">public</span> <span class="pl-en">QuadraticEquationSolver</span>(<span class="pl-k">double</span> <span class="pl-v">a</span>, <span class="pl-k">double</span> <span class="pl-v">b</span>, <span class="pl-k">double</span> <span class="pl-v">c</span>) {
        <span class="pl-v">this</span><span class="pl-k">.</span>a <span class="pl-k">=</span> a;
        <span class="pl-v">this</span><span class="pl-k">.</span>b <span class="pl-k">=</span> b;
        <span class="pl-v">this</span><span class="pl-k">.</span>c <span class="pl-k">=</span> c;
      }

      <span class="pl-k">public</span> <span class="pl-smi">Solutions</span> <span class="pl-en">solve</span>() {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">Solutions</span>(
            (<span class="pl-k">-</span>b <span class="pl-k">+</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>sqrt(b <span class="pl-k">*</span> b <span class="pl-k">-</span> <span class="pl-c1">4</span> <span class="pl-k">*</span> c <span class="pl-k">*</span> a)) <span class="pl-k">/</span> (<span class="pl-c1">2</span> <span class="pl-k">*</span> a),
            (<span class="pl-k">-</span>b <span class="pl-k">-</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>sqrt(b <span class="pl-k">*</span> b <span class="pl-k">-</span> <span class="pl-c1">4</span> <span class="pl-k">*</span> c <span class="pl-k">*</span> a)) <span class="pl-k">/</span> (<span class="pl-c1">2</span> <span class="pl-k">*</span> a)
        );
      }
    }</pre></div>

<p>Did you already notice the bugs that this program has?</p>

<ul>
<li>It doesn't consider equations that do not have solutions in real.</li>
<li>If it's not a quadratic equation but a linear one, how should it behave?</li>
<li>Errors. How should it handle errors? To what extent error is acceptable?</li>
<li>Overflows. If b * b, 4 * c * a, etc become bigger than Double.MAX_VALUE (or 
smaller than Double.MIN_VALUE), how should it handle them?</li>
<li>Shouldn't we set some limits for a, b, and c? Both to make errors small enough 
and prevent overflows from happening.</li>
<li>etc. (maybe)</li>
</ul>

<p>Try to find (and reproduce) these bugs using JCUnit and fix them.</p>

<h3>
<a id="quadraticequationsolvertestjava-test" class="anchor" href="#quadraticequationsolvertestjava-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>QuadraticEquationSolverTest.java (Test)</h3>

<p>QuadraticEquationSolverTest1 is a test class for QuadraticEquationSolver class.</p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-c">// QuadraticEquationSolverTest1.java</span>
    @RunWith(<span class="pl-smi">JCUnit</span><span class="pl-k">.</span>class)
    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">QuadraticEquationSolverTest1</span> {
        <span class="pl-k">@FactorField</span>
        <span class="pl-k">public</span> <span class="pl-k">int</span> a;
        <span class="pl-k">@FactorField</span>
        <span class="pl-k">public</span> <span class="pl-k">int</span> b;
        <span class="pl-k">@FactorField</span>
        <span class="pl-k">public</span> <span class="pl-k">int</span> c;

        <span class="pl-k">@Test</span>
        <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">test</span>() {
            <span class="pl-smi">QuadraticEquationSolver</span><span class="pl-k">.</span><span class="pl-smi">Solutions</span> s <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">QuadraticEquationSolver</span>(a, b,
                    c)<span class="pl-k">.</span>solve();
            assertEquals(<span class="pl-c1">0.0</span>, a <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">+</span> b <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">+</span> c);
            assertEquals(<span class="pl-c1">0.0</span>, a <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">+</span> b <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">+</span> c);
        }
    }
</pre></div>

<p>If you run this test class, JCUnit generates about fifty test cases and run them.
By default, it generates the test cases by using 'all-pairs' technique.</p>

<h1>
<a id="tips" class="anchor" href="#tips" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tips</h1>

<h2>
<a id="tip-1-customizing-domains-of-factorfield-annotated-fields-1" class="anchor" href="#tip-1-customizing-domains-of-factorfield-annotated-fields-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 1: Customizing domains of @FactorField annotated fields (1)</h2>

<p>JCUnit creates test cases by assigning a value, picked up from a hardcoded set of values defined for each type, to each '@FactorField' annotated field in a test class.
For example, if a member is annotated with '@FactorField' and its type is int, JCUnit will pick up a value from a set
{1, 0, -1, 100, -100, Integer.MAX_VALUE, Integer.MIN_VALUE}.
But this set is just a 'default' and you can customize it by using (overriding) an 'xyzLevels' attribute of a '@FactorField' annotation, 
where 'xyz' is a primitive types.</p>

<div class="highlight highlight-source-java"><pre>
    @FactorField(intLevels <span class="pl-k">=</span> { <span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-k">-</span><span class="pl-c1">1</span>, <span class="pl-k">-</span><span class="pl-c1">2</span>, <span class="pl-c1">100</span>, <span class="pl-k">-</span><span class="pl-c1">100</span>, <span class="pl-c1">10000</span>, <span class="pl-k">-</span><span class="pl-c1">10000</span> })
    <span class="pl-k">public</span> <span class="pl-k">int</span> a;
</pre></div>

<p>Above is an example of the use the 'intLevels' attribute.</p>

<h2>
<a id="tip-2-customizing-domains-of-factorfield-annotated-fields-2" class="anchor" href="#tip-2-customizing-domains-of-factorfield-annotated-fields-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 2: Customizing domains of @FactorField annotated fields (2)</h2>

<p>By using 'levelsProvider' parameter of '@FactorField' and creating a static method whose name is the same as the annotated field's name,
you can customize the domain of a certain field in a much more flexible way.</p>

<p>The method mustn't have any parameters and its return value must be an array of the field's type.</p>

<p>Below is the example for that sort of function.</p>

<div class="highlight highlight-source-java"><pre>
    @FactorField(levelsProvider <span class="pl-k">=</span> <span class="pl-smi">MethodLevelsProvider</span><span class="pl-k">.</span>class)
    <span class="pl-k">public</span> <span class="pl-k">int</span> a;

    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">int</span>[] a() {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">int</span>[]{<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>};
    }
</pre></div>

<p>The values returned by the method will be picked up and assigned to the field 'a' by the framework one by one.
And you need to use 'levelsProvider' attribute when you are going to use non-primitive, non-enum, nor non-string values as levels for a factor.</p>

<h2>
<a id="tip-3-customizing-the-strength-of-t-wise-testing" class="anchor" href="#tip-3-customizing-the-strength-of-t-wise-testing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 3: Customizing the strength of t-wise testing.</h2>

<p>Add parameter 'generator = <a href="https://github.com/Generator" class="user-mention">@Generator</a>(IPO2TestCaseGenerator.class)' explicitly to the '@TestCaseGeneration',
annotation for 'QuadraticEquationSolverTest1.java' and set the first parameter, which represents a 'strength'. </p>

<div class="highlight highlight-source-java"><pre>
    @RunWith(<span class="pl-smi">JCUnit</span><span class="pl-k">.</span>class)
    @TestCaseGeneration(
            generator <span class="pl-k">=</span> @Generator(
                    value <span class="pl-k">=</span> <span class="pl-smi">IPO2TestCaseGenerator</span><span class="pl-k">.</span>class,
                    params <span class="pl-k">=</span> { @Param(<span class="pl-s"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>) }))
    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">QuadraticEquationSolverTest1</span> {</pre></div>

<p>In this example, the line</p>

<div class="highlight highlight-source-java"><pre>
    params <span class="pl-k">=</span> { @Param(<span class="pl-s"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>) }))
</pre></div>

<p>configures the strength of the t-wise tests performed by JCUnit.</p>

<p>And '<a href="https://github.com/Param" class="user-mention">@Param</a>' annotation is a standard way to give a parameter to JCUnit plugins (excepting '@FactorField', which requires more conciseness). 
It takes a string array as its 'value'(and remember that you can omit curly braces if there is only one element in the array). 
JCUnit internally translates those values accordingly.</p>

<h2>
<a id="tip-4-defining-constraints" class="anchor" href="#tip-4-defining-constraints" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 4: Defining constraints.</h2>

<p>In testings, we sometimes want to exclude a certain pair (, a triple, or a tuple) from the test cases since there are constraints in the test domain.</p>

<p>For example, suppose there is a software system which has 100 parameters and doesn't accept any larger value than 1,000 for parameter x1.
And it validates all the parameters and immediately exits if any one of them is invalid at start up.</p>

<p>Combinatorial testing is an effort to cover pairs (or tuples) with test cases as less as possible to find bugs which cannot be found by testing any single input parameter.
If a test case, which can possibly contain a lot of meaningful pairs, is revoked by a single parameter, it means the coverage of the test suite will be damaged. 
Below are the links that would be helpful for understanding how much constraint managements are important in combinatorial testing area. </p>

<ul>
<li><a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?reload=true&amp;arnumber=6221818">Combinatorial test cases with constraints in software systems</a></li>
<li><a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?reload=true&amp;arnumber=6569736">An Efficient Algorithm for Constraint Handling in Combinatorial Test Generation</a></li>
</ul>

<p>(Of course we want to test the behaviors on such illegal inputs. It will be discussed in the next tip.) </p>

<p>For this purpose, JCUnit has a mechanism called 'constraints manager'.
To use a constraint manager, you can do below</p>

<div class="highlight highlight-source-java"><pre>
    @RunWith(<span class="pl-smi">JCUnit</span><span class="pl-k">.</span>class)
    @TestCaseGeneration(
        constraint <span class="pl-k">=</span> @Constraint(
            value <span class="pl-k">=</span> <span class="pl-smi">QuadraticEquationSolverTestX</span><span class="pl-k">.</span><span class="pl-smi">CM</span><span class="pl-k">.</span>class ))
    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">QuadraticEquationSolverTestX</span> {
    <span class="pl-c1">...</span></pre></div>

<p>'CM' is a name of inner class which implements 'ConstraintManager' interface and checks if a given tuple violates any constraints in the test domain or not.
Unfortunately you cannot use anonymous classes because a value passed to an annotation as its parameter must be a constant and Java's anonymous classes cannot be one.</p>

<p>If you want to exclude test cases that violate a discriminant of the quadratic equation formula and also make sure the given equation is a quadratic, 
not a linear, the definition of 'CM' would be</p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">CM</span> <span class="pl-k">extends</span> <span class="pl-e">ConstraintManagerBase</span> {
        <span class="pl-k">@Override</span>
        <span class="pl-k">public</span> <span class="pl-k">boolean</span> <span class="pl-en">check</span>(<span class="pl-smi">Tuple</span> <span class="pl-v">tuple</span>) <span class="pl-k">throws</span> <span class="pl-smi">JCUnitSymbolException</span> {
          <span class="pl-k">if</span> (<span class="pl-k">!</span>tuple<span class="pl-k">.</span>containsKey(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> <span class="pl-k">!</span>tuple<span class="pl-k">.</span>containsKey(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> <span class="pl-k">!</span>tuple
              .containsKey(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>)) {
            <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-smi">UndefinedSymbol</span>();
          }
          <span class="pl-k">int</span> a <span class="pl-k">=</span> (<span class="pl-smi">Integer</span>) tuple<span class="pl-k">.</span>get(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>);
          <span class="pl-k">int</span> b <span class="pl-k">=</span> (<span class="pl-smi">Integer</span>) tuple<span class="pl-k">.</span>get(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>);
          <span class="pl-k">int</span> c <span class="pl-k">=</span> (<span class="pl-smi">Integer</span>) tuple<span class="pl-k">.</span>get(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>);
          <span class="pl-k">return</span> a <span class="pl-k">!=</span> <span class="pl-c1">0</span> <span class="pl-k">&amp;&amp;</span> b <span class="pl-k">*</span> b <span class="pl-k">-</span> <span class="pl-c1">4</span> <span class="pl-k">*</span> c <span class="pl-k">*</span> a <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span>;
        }
    }</pre></div>

<p>'ConstraintManagerBase' is a helper class that makes it easy to implement a ConstraintManager.
All that you need is overriding 'boolean check(Tuple)' method.
In case the passed tuple violates your constraints, make it return false.
A test case is passed as a tuple, you need to use 'get' method of it to retrieve the value (level) of it.</p>

<p>"a", "b", or "c" are the names of the fields annotated with '@FactorField'. JCUnit accesses them using 'reflection' techniques of Java.
JCUnit avoids using tuples for which check method of the specified constraint manager returns 'false'.</p>

<h2>
<a id="tip-5-writing-test-cases-for-error-handling-negative-tests" class="anchor" href="#tip-5-writing-test-cases-for-error-handling-negative-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 5: Writing test cases for error handling (negative tests)</h2>

<p>That being said, handling errors appropriately is another concern.
A program must complain of invalid parameters in an appropriate way.
And this characteristic is another aspect of software under test to be tested.</p>

<p>You can do it by overriding 'getViolations' method of a constraint manager and switching the verification procedures based on a test's 'sub-identifier'.</p>

<p>First, by overriding method, return test cases that explicitly violate the constraint represented by the constraint manager class itself.</p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">CM</span> <span class="pl-k">extends</span> <span class="pl-e">ConstraintManagerBase</span> {
        <span class="pl-k">@Override</span>
        <span class="pl-k">public</span> <span class="pl-k">boolean</span> <span class="pl-en">check</span>(<span class="pl-smi">Tuple</span> <span class="pl-v">tuple</span>) <span class="pl-k">throws</span> <span class="pl-smi">JCUnitSymbolException</span> {
            <span class="pl-c1">...</span>
        }

        <span class="pl-k">@Override</span>
        <span class="pl-k">public</span> <span class="pl-k">List&lt;<span class="pl-smi">Tuple</span>&gt;</span> <span class="pl-en">getViolations</span>() {
            <span class="pl-k">List&lt;<span class="pl-smi">Tuple</span>&gt;</span> ret <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">LinkedList&lt;<span class="pl-smi">Tuple</span>&gt;</span>();
            ret<span class="pl-k">.</span>add(createTestCase(<span class="pl-s"><span class="pl-pds">"</span>a=0<span class="pl-pds">"</span></span>, createTestCase(<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">1</span>)));
            ret<span class="pl-k">.</span>add(createTestCase(<span class="pl-s"><span class="pl-pds">"</span>b*b-4ca&lt;0<span class="pl-pds">"</span></span>, createTestCase(<span class="pl-c1">100</span>, <span class="pl-c1">1</span>, <span class="pl-c1">100</span>)));
            ret<span class="pl-k">.</span>add(createTestCase(<span class="pl-s"><span class="pl-pds">"</span>nonsense 1=0<span class="pl-pds">"</span></span>, createTestCase(<span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">1</span>)));
            <span class="pl-k">return</span> ret;
        }

        <span class="pl-k">private</span> <span class="pl-smi">Tuple</span> <span class="pl-en">createTestCase</span>(<span class="pl-k">int</span> <span class="pl-v">a</span>, <span class="pl-k">int</span> <span class="pl-v">b</span>, <span class="pl-k">int</span> <span class="pl-v">c</span>) {
            <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">Tuple</span>.<span class="pl-smi">Builder</span>()<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>, a)<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>, b)<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>, c)<span class="pl-k">.</span>build();
        }
    }</pre></div>

<p>Now you enhance your test case so that it verifies the software under test behaves correctly in case invalid parameters are given.
Let's assume that the SUT should return null if one of the parameters 'a', 'b', or 'c' is not valid. </p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> test() {
        <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>a=0<span class="pl-pds">"</span></span><span class="pl-k">.</span>equals(desc<span class="pl-k">.</span>getSubIdentifier())) {
          assertEquals(<span class="pl-c1">null</span>, s);
        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>b*b-4ca&lt;0<span class="pl-pds">"</span></span><span class="pl-k">.</span>equals(desc<span class="pl-k">.</span>getSubIdentifier())) {
          assertEquals(<span class="pl-c1">null</span>, s);
        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>nonsense 1=0<span class="pl-pds">"</span></span><span class="pl-k">.</span>equals(desc<span class="pl-k">.</span>getSubIdentifier())) {
          assertEquals(<span class="pl-c1">null</span>, s);
        } <span class="pl-k">else</span> {
            <span class="pl-smi">QuadraticEquationSolver</span><span class="pl-k">.</span><span class="pl-smi">Solutions</span> s <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">QuadraticEquationSolver</span>(a, b,
                    c)<span class="pl-k">.</span>solve();
            assertEquals(<span class="pl-c1">0.0</span>, a <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">+</span> b <span class="pl-k">*</span> s<span class="pl-k">.</span>x1 <span class="pl-k">+</span> c);
            assertEquals(<span class="pl-c1">0.0</span>, a <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">+</span> b <span class="pl-k">*</span> s<span class="pl-k">.</span>x2 <span class="pl-k">+</span> c);
        }
    }</pre></div>

<h2>
<a id="tip-6-filtering-test-cases" class="anchor" href="#tip-6-filtering-test-cases" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 6: Filtering test cases</h2>

<p>From time to time, you want to disable/enable test cases in order to concentrate some among all of them.
'@Precondition' notation is your friend in this use case.</p>

<p>You can define a method returning boolean and with no parameter like below,</p>

<div class="highlight highlight-source-java"><pre>
    @FactorField(intLevels <span class="pl-k">=</span> { <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span> })
    <span class="pl-k">public</span> <span class="pl-k">int</span> a;

    <span class="pl-c1">...</span>

    @<span class="pl-smi">Precondition</span>
    <span class="pl-k">public</span> <span class="pl-k">boolean</span> filterMethod() {
      <span class="pl-k">return</span> <span class="pl-v">this</span><span class="pl-k">.</span>a <span class="pl-k">==</span> <span class="pl-c1">3</span>;
    }</pre></div>

<p>By defining such a method, you can disable test cases which result in the method's value false.
In the example above, test cases whose factor 'a' is non 3 will no longer be executed.</p>

<h2>
<a id="tip-7-executing-test-methods-based-on-given-conditions" class="anchor" href="#tip-7-executing-test-methods-based-on-given-conditions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 7: Executing test methods based on given conditions</h2>

<p>Also you sometimes want to let JCUnit decide a certain test method should be executed 
based on some conditions automatically.</p>

<p>E.g, in case you are testing quadratic equation solver program, if a discriminant of a given
 equation is negative, you want to check if error handling is working correct, 
 but probably you don't want to perform a test to check if the solutions are precise.
 Of course the value is non-negative, you don't need a test for error handling and 
 do need a test for solutions' precision.</p>

<p>For this purpose, JCUnit provides another annotation '<a href="https://github.com/When" class="user-mention">@When</a>'.
Below is an example to illustrate how this feature should be used.</p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    @When( <span class="pl-s"><span class="pl-pds">"</span>discriminantIsNonNegative<span class="pl-pds">"</span></span> )
    <span class="pl-k">public</span> <span class="pl-k">void</span> thenSolveQuadraticEquation() {
      <span class="pl-c1">...</span>
    }</pre></div>

<p>JCUnit will invoke a method whose name is 'discriminantIsNonNegative' and iff its
return value is true, this test method will be executed.</p>

<p>If the coefficients of an equation, i.e. factors of this test class, are a, b, and c, 
the method would look like below. </p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-k">public</span> <span class="pl-k">boolean</span> discriminantIsNonNegative() {
        <span class="pl-k">return</span> b <span class="pl-k">*</span> b <span class="pl-k">-</span> <span class="pl-c1">4</span> <span class="pl-k">*</span> c <span class="pl-k">*</span> a <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span>;
    }</pre></div>

<p>If you want to add another condition you can also do below. </p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    @When( <span class="pl-s"><span class="pl-pds">"</span>aIsNonZero&amp;&amp;discriminantIsNonNegative<span class="pl-pds">"</span></span> )
    <span class="pl-k">public</span> <span class="pl-k">void</span> thenSolveQuadraticEquation() {
        <span class="pl-c1">...</span>
    }</pre></div>

<p>In this example, you are making sure that a is not zero AND the discriminant is non-negative
before this method is executed.</p>

<p>Also you can do</p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    @When( <span class="pl-s"><span class="pl-pds">"</span>!discriminantIsNonNegative<span class="pl-pds">"</span></span> )
    <span class="pl-k">public</span> <span class="pl-k">void</span> thenAnErrorWillBeReported() {
        <span class="pl-c1">....</span>
    }</pre></div>

<p>And, to express 'OR', do</p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    @When({<span class="pl-s"><span class="pl-pds">"</span>!discriminantIsNonNegative<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>!aIsNonZero<span class="pl-pds">"</span></span>})
    <span class="pl-k">public</span> <span class="pl-k">void</span> thenAnErrorWillBeReported() {
        <span class="pl-c1">....</span>
    }</pre></div>

<p>Unfortunately you cannot use parentheses as of now.</p>

<h2>
<a id="tip-8-as-a-pairwise-test-generator" class="anchor" href="#tip-8-as-a-pairwise-test-generator" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 8: As a pairwise test generator</h2>

<h3>
<a id="under-junit-execution-recommended" class="anchor" href="#under-junit-execution-recommended" aria-hidden="true"><span class="octicon octicon-link"></span></a>Under JUnit execution (recommended)</h3>

<p>By creating a test method below, which just prints test case definition, you can use JCUnit as a pairwise (or t-wise) test case generator.</p>

<div class="highlight highlight-source-java"><pre>
    @<span class="pl-smi">Test</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> printTestCase() {
        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-smi">TupleUtils</span><span class="pl-k">.</span>toString(<span class="pl-smi">TestCaseUtils</span><span class="pl-k">.</span>toTestCase(<span class="pl-v">this</span>)));
    }</pre></div>

<p>The output will be a text whose lines are JSON objects and look like,</p>

<pre><code>
    {"browser":"IE","cpuClockInGHz":1.5,"edition":"Home Premium","gramInMB":128,"hddSizeInGB":100,"ramInGB":8}
    {"browser":"IE","cpuClockInGHz":2.5,"edition":"Enterprise","gramInMB":256,"hddSizeInGB":30,"ramInGB":1}
    {"browser":"IE","cpuClockInGHz":3.0,"edition":"Home Basic","gramInMB":512,"hddSizeInGB":50,"ramInGB":2}
    {"browser":"Opera","cpuClockInGHz":1.5,"edition":"Ultimate","gramInMB":512,"hddSizeInGB":20,"ramInGB":1}
    {"browser":"Opera","cpuClockInGHz":2.0,"edition":"Professional","gramInMB":256,"hddSizeInGB":50,"ramInGB":8}
    ...
</code></pre>

<p>You can refer to a following example for this use case. </p>

<ul>
<li><a href="https://github.com/dakusui/jcunit/blob/0.5.x/src/test/java/com/github/dakusui/jcunit/examples/testgen/TestGen.java">TestGen.java</a></li>
</ul>

<h3>
<a id="without-junit" class="anchor" href="#without-junit" aria-hidden="true"><span class="octicon octicon-link"></span></a>Without JUnit</h3>

<p>Apparently people sometimes want to use JCUnit not as a JUnit runner but as a pairwise (t-wise)
test generator library.</p>

<p>You can do it by doing this.</p>

<div class="highlight highlight-source-java"><pre>
      <span class="pl-k">public</span> <span class="pl-k">void</span> moreFluentStyleRun(<span class="pl-smi">PrintStream</span> ps) {
        <span class="pl-smi">TupleGenerator</span> tg <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">TupleGenerator</span>.<span class="pl-smi">Builder</span>()<span class="pl-k">.</span>setFactors(
            <span class="pl-k">new</span> <span class="pl-smi">Factors</span>.<span class="pl-smi">Builder</span>()
                .add(<span class="pl-s"><span class="pl-pds">"</span>OS<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Windows<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Linux<span class="pl-pds">"</span></span>)
                .add(<span class="pl-s"><span class="pl-pds">"</span>Browser<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Chrome<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Firefox<span class="pl-pds">"</span></span>)
                .add(<span class="pl-s"><span class="pl-pds">"</span>Bits<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>32<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>64<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>build()
        )<span class="pl-k">.</span>build();
        <span class="pl-k">for</span> (<span class="pl-smi">Tuple</span> each <span class="pl-k">:</span> tg) {
          ps<span class="pl-k">.</span>println(each);
        }
      }</pre></div>

<p>This should print out something like following.</p>

<pre><code>
    {Bits=32, Browser=Chrome, OS=Windows}
    {Bits=64, Browser=Firefox, OS=Windows}
    {Bits=64, Browser=Chrome, OS=Linux}
    {Bits=32, Browser=Firefox, OS=Linux}
</code></pre>

<p>You can refer to a following example for this use case. </p>

<ul>
<li><a href="https://github.com/dakusui/jcunit/blob/0.5.x/src/test/java/com/github/dakusui/jcunit/examples/testgen/TestGenWithoutJUnit.java">TestGenWithoutJUnit.java</a></li>
</ul>

<p>Above mentioned code doesn't use JUnit's functionality at all and from JCUnit 0.5.4 on, 
dependency on JUnit is marked optional in pom.xml of JCUnit. Therefore it should even 
work without having JUnit library in your classpath at all.
But if you are using earlier version of JCUnit, or somehow unwanted version of JUnit 
is picked up, probably you need to 'exclude' the dependency. 
please refer to <a href="https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html">Apache Maven Project page</a></p>

<h2>
<a id="tip-9-modeling-a-finite-state-machine" class="anchor" href="#tip-9-modeling-a-finite-state-machine" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 9: Modeling a finite state machine</h2>

<p>Probably your SUT might have a specification where users need to follow a certain 
manner like "1. You will initialize the object, 2. Now you can do A or B, 3.
If you did A in step 2, you can do A1, A2, or B1. Otherwise you can only do B1.",
and A, B, etc can take a few parameters respectively.</p>

<p>You might be able to write a constraint manager to describe this sort of specification
 but it would be very complicated, boring, and error prone task.</p>

<p>JCUnit has a feature called "FSM support" and the detail and how to use it are 
discussed in a separate document. Please refer to <a href="FSM-README.md">FSM/JCUnit</a> </p>

<h1>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h1>

<p>For more examples, see</p>

<ul>
<li><a href="https://github.com/dakusui/jcunit/tree/develop/src/test/java/com/github/dakusui/jcunit/examples/quadraticequation">Examples</a></li>
</ul>

<h1>
<a id="refefences" class="anchor" href="#refefences" aria-hidden="true"><span class="octicon octicon-link"></span></a>Refefences</h1>

<ul>
<li>[1] "Pairwise Testing", A website for pairwise technique</li>
<li>[2] "PICT", A most known powerful pairwise tool by microsoft, which is now open source.
[1] <a href="http://www.pairwise.org/">http://www.pairwise.org/</a>
[2] <a href="https://github.com/microsoft/pict">https://github.com/microsoft/pict</a>
</li>
</ul>

<h1>
<a id="copyright-and-license" class="anchor" href="#copyright-and-license" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyright and license</h1>

<p>Copyright 2013 Hiroshi Ukai.</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this work except in compliance with the License.
You may obtain a copy of the License in the LICENSE file, or at:</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
